{
  "metadata": {
    "version": 1,
    "disable_limits": false,
    "instance_type": "ml.m5.4xlarge"
  },
  "parameters": [],
  "nodes": [
    {
      "node_id": "3b745a56-e93d-4761-8492-36239687af92",
      "type": "SOURCE",
      "operator": "sagemaker.s3_source_0.1",
      "parameters": {
        "dataset_definition": {
          "__typename": "S3CreateDatasetDefinitionOutput",
          "datasetSourceType": "S3",
          "name": "loans-part-1.csv",
          "description": null,
          "s3ExecutionContext": {
            "__typename": "S3ExecutionContext",
            "s3Uri": "s3://sagemaker-us-east-1-119174016168/loan-default/loans-part-1.csv",
            "s3ContentType": "csv",
            "s3HasHeader": true,
            "s3FieldDelimiter": ",",
            "s3DirIncludesNested": false,
            "s3AddsFilenameColumn": false,
            "s3RoleArn": null
          }
        }
      },
      "inputs": [],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "fa77e4f9-8ec2-4ccb-9cb6-a5849bd447b5",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.infer_and_cast_type_0.1",
      "parameters": {},
      "trained_parameters": {
        "schema": {
          "id": "long",
          "loan_status": "string",
          "loan_amount": "long",
          "funded_amount_by_investors": "float",
          "loan_term": "long",
          "interest_rate": "float",
          "installment": "float",
          "grade": "string",
          "sub_grade": "string",
          "verification_status": "string",
          "issued_on": "date",
          "purpose": "string",
          "dti": "float",
          "earliest_credit_line": "date",
          "inquiries_last_6_months": "long",
          "open_credit_lines": "long",
          "derogatory_public_records": "long",
          "revolving_line_utilization_rate": "float",
          "total_credit_lines": "long"
        }
      },
      "inputs": [
        {
          "name": "default",
          "node_id": "3b745a56-e93d-4761-8492-36239687af92",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "90185f7c-8cf0-4199-b2cc-27c7a183633d",
      "type": "SOURCE",
      "operator": "sagemaker.athena_source_0.1",
      "parameters": {
        "dataset_definition": {
          "datasetSourceType": "Athena",
          "name": "loans-part-2.csv",
          "catalogName": "AwsDataCatalog",
          "databaseName": "sagemaker_data_wrangler",
          "queryString": "select * from loan_default_demographics",
          "s3OutputLocation": "s3://sagemaker-us-east-1-119174016168/athena/athena/",
          "outputFormat": "parquet",
          "workgroup": null,
          "workgroupOutputLocation": null,
          "enforceWorkgroupConfiguration": false
        },
        "dataSource": {}
      },
      "trained_parameters": {
        "query_execution_id": "f0a21a5f-bf6e-4148-8727-110a7b186e26",
        "unload_table_name": "9bfa03fa38674a69a724f9834167cf63",
        "unload_s3_output_location": "s3://sagemaker-us-east-1-119174016168/athena/athena/9bfa03fa38674a69a724f9834167cf63/data/"
      },
      "inputs": [],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "36aa74f5-0a0a-4c3d-a99b-150089266868",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.infer_and_cast_type_0.1",
      "parameters": {},
      "trained_parameters": {
        "schema": {
          "employer_title": "string",
          "home_ownership": "string",
          "id": "long",
          "employment_length": "float",
          "annual_income": "float"
        }
      },
      "inputs": [
        {
          "name": "default",
          "node_id": "90185f7c-8cf0-4199-b2cc-27c7a183633d",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "54788c9c-4580-4ffc-999e-a40ff87f880b",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.join_tables_0.1",
      "name": "joined-dataset",
      "parameters": {
        "left_column": "id",
        "right_column": "id",
        "join_type": "inner"
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "fa77e4f9-8ec2-4ccb-9cb6-a5849bd447b5",
          "output_name": "default"
        },
        {
          "name": "df",
          "node_id": "36aa74f5-0a0a-4c3d-a99b-150089266868",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "613bac0b-c31f-4f53-8686-401f594e3634",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.manage_columns_0.1",
      "parameters": {
        "operator": "Drop column",
        "drop_column_parameters": {
          "column_to_drop": [
            "id_0",
            "id_1"
          ]
        }
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "54788c9c-4580-4ffc-999e-a40ff87f880b",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    }
  ]
}